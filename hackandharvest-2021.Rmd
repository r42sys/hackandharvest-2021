---
title: "HACK AND HARVEST Hackathon 2021"
subtitle: "Elementare CO<sub>2</sub> Bilanz für Konstanz"
author: 
  name: Ralph Rogge
date: 17. April 2021
output:
  html_document: 
    css: hackandharvest-2021.css
---

Ziel dieses 12 Stunden Mikro-Forschungsprojektes, im Rahmen des [HACK AND HARVEST](https://www.hackandharvest.farm) 2021, war die Berechnung der elementaren CO<sub>2</sub>-Bilanz für Konstanz, die Differenz von CO<sub>2</sub>-Erzeugung von Konstanzer:innen durch Atmung auf der einen und der CO<sub>2</sub>-Aufnahme der konstanzer Vegetation auf der anderen Seite. Beschränkt habe ich mich hier, aufgrund der Datenlage, auf erwachsene Konstanzer einerseits und Bäume der Stadt Konstanz andererseits. 


```{r}
Sys.setlocale("LC_ALL","de_DE")
```

```{r}
rm(list=ls())
```

```{r, message=FALSE, warning=FALSE}
library(forcats)
library(ggplot2)
library(ggmap)
library(dplyr)
library(kableExtra)
library(osmdata)
library(tidyr)
```

## Explorative Datenanalyse

### Bäume der Sadt Konstanz

```{r}
raw <- read.csv('data/KN_Baumkataster_2020.csv', strip.white=TRUE) %>%
    rename(x = X.X) %>%
    rename(y = Y) %>%
    rename(hoehe = hoeheM) %>%
    rename(kronendurchmesser = kronendurchmesserM) %>%
    rename(stammumfang = stammumfangCM) %>%
    rename(name_de = Name_dt) %>%
    rename(name_la = Name_lat) %>%
    rename(standort = location)
```

```{r trim, echo=FALSE}
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
```

```{r, echo=FALSE}
kataster <- raw %>%
    mutate(name_de = replace(name_de, name_de == "Amberbaum", "Amberbäume, Amberbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Apfel 'Boskoop'", "Äpfel, Apfel, 'Boskoop")) %>%
    mutate(name_de = replace(name_de, name_de == "Apfeldorn", "Weißdorne, Apfeldorn")) %>%
    mutate(name_de = replace(name_de, name_de == "Atlas-Zeder", "Zedern, Atlas-Zeder")) %>%    
    mutate(name_de = replace(name_de, name_de == "Bergahorn 'Rotterdam'", "Ahorne, Bergahorn 'Rotterdam'")) %>%
    mutate(name_de = replace(name_de, name_de == "Berliner Lorbeer-Pappel", "Pappeln, Berliner Lorbeerpappel")) %>%
    mutate(name_de = replace(name_de, name_de == "Blasenesche", "Koelreuteria, Blasenesche")) %>%
    mutate(name_de = replace(name_de, name_de == "blaue Kegel-Zypresse", "Zypressen, Blaue Kegelzypresse")) %>%
    mutate(name_de = replace(name_de, name_de == "Blaue Scheinzypresse", "Scheinzypressen, Blaue Scheinzypresse")) %>%    
    mutate(name_de = replace(name_de, name_de == "Blaue Stechfichte", "Fichten, Stech-Fichte ''Glauca'")) %>%    
    mutate(name_de = replace(name_de, name_de == "Blut-Buche", "Buchen, Blutbuche")) %>%
    mutate(name_de = replace(name_de, name_de == "Blutpflaume", "Prunus, Blutpflaume")) %>%
    mutate(name_de = replace(name_de, name_de == "Brabanter Silber-Linde", "Linden, Silberlinde 'Brabant'")) %>%
    mutate(name_de = replace(name_de, name_de == "Buchsbaum", "Buchsbäume, Buchsbaum")) %>%    
    mutate(name_de = replace(name_de, name_de == "Chinesische Birne", "Birnen, Chinesische Birne")) %>%
    mutate(name_de = replace(name_de, name_de == "Dornenlose Gleditschie", "Gleditschien, Dornenlose Gleditschie")) %>%
    mutate(name_de = replace(name_de, name_de == "Douglasie", "Douglasien, Douglasie")) %>%
    mutate(name_de = replace(name_de, name_de == "Einblättrige Esche", "Eschen, Einblättrige Esche")) %>%
    mutate(name_de = replace(name_de, name_de == "Elsbeere", "Mehlbeeren, Elsbeere")) %>%
    mutate(name_de = replace(name_de, name_de == "Esche 'Altena'", "Eschen, Esche 'Altena'")) %>%
    mutate(name_de = replace(name_de, name_de == "Esche 'Geessink'", "Eschen, Esche 'Geessink'")) %>%
    mutate(name_de = replace(name_de, name_de == "Faulbaum", "Kreuzdorn, Faulbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Felsenbirne 'Robin Hill'", "Felsenbirnen, Felsenbirne 'Robin Hill'")) %>%    
    mutate(name_de = replace(name_de, name_de == "Flatter-Ulme", "Ulmen, Flatterulme")) %>%
    mutate(name_de = replace(name_de, name_de == "Frühe Zier-Kirsche", "Prunus, Frühe Zierkirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Gefülltblühende Roßkastanie", "Roßkastanien, Gefülltblühende Roßkastanie")) %>%
    mutate(name_de = replace(name_de, name_de == "Gefüllte Vogel-Kirsche", "Prunus, Gefüllte Vogelkirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Ginkgo", "Ginkgo, Ginkgo")) %>%
    mutate(name_de = replace(name_de, name_de == "Gold-Birke", "Birken, Gold-Birke")) %>%
    mutate(name_de = replace(name_de, name_de == "Großer Lebensbaum", "Lebensbäume, Großer Lebensbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Großlaubige Mehlbeere", "Mehlbeeren, Großlaubige Mehlbeere")) %>%
    mutate(name_de = replace(name_de, name_de == "Hainbuche 'Frans Fontaine'", "Hainbuchen, Hainbuche 'Frans Fontaine'")) %>%
    mutate(name_de = replace(name_de, name_de == "Hänge-Birke", "Birken, Hänge-Birke")) %>%
    mutate(name_de = replace(name_de, name_de == "Herbstblühende Schnee-Kirsche", "Prunus, Winterkirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Himalaja-Birke", "Birken, Himalaja-Birke")) %>%    
    mutate(name_de = replace(name_de, name_de == "Holzbirne Beech Hill", "Birnen, Holzbirne 'Beech Hill'")) %>%    
    mutate(name_de = replace(name_de, name_de == "Hopfenbuche", "Hopfenbuchen, Hopfenbuche")) %>%    
    mutate(name_de = replace(name_de, name_de == "Judasblattbaum", "Judasblattbäume, Judasbaum")) %>%    
    mutate(name_de = replace(name_de, name_de == "Kaiser-Linde", "Linden, Kaiser-Linde")) %>%
    mutate(name_de = replace(name_de, name_de == "Kegel-Feld-Ahorn", "Ahorne, Kegel-Feldahorn")) %>%
    mutate(name_de = replace(name_de, name_de == "Kegel-Linde 'Glenleven'", "Linden, Kegel-Linde 'Glenleven'")) %>%
    mutate(name_de = replace(name_de, name_de == "Kegel-Silber-Weide", "Weiden, Silber-Weide 'Liempde'")) %>%
    mutate(name_de = replace(name_de, name_de == "Konstanzer Mostbirne", "Birnen, Konstanzer Mostbirne")) %>%
    mutate(name_de = replace(name_de, name_de == "Korkenzieher-Weide", "Weiden, Korkenzieher-Weide")) %>%
    mutate(name_de = replace(name_de, name_de == "Kuchenbaum", "Japanischer Kuchenbäume, Japanischer Kuchenbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Kugel-Esche", "Eschen, Kugel-Esche")) %>%
    mutate(name_de = replace(name_de, name_de == "Kugelrobinie", "Robinien, Kugel-Robinie")) %>%
    mutate(name_de = replace(name_de, name_de == "Kultur-Apfel", "Äpfel, Kultur-Apfel")) %>%
    mutate(name_de = replace(name_de, name_de == "Lawson´s Scheinzypresse", "Scheinzypressen, Scheinzypresse 'Lawson'")) %>%
    mutate(name_de = replace(name_de, name_de == "Linde \"Greespire\"", "Linden, Winterlinde 'Greenspire'")) %>%
    mutate(name_de = replace(name_de, name_de == "Mammutbaum", "Sequoiadendron, Riesenmammutbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Mehlbeere", "Mehlbeeren, Mehlbeere")) %>%
    mutate(name_de = replace(name_de, name_de == "Mirabelle", "Prunus, Mirabelle")) %>%
    mutate(name_de = replace(name_de, name_de == "Nelken-Kirsche", "Prunus, Japanische Nelkenkirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Pflaumenblättriger Weißdorn", "Weißdorne, Pflaumenblättriger Weißdorn")) %>%    
    mutate(name_de = replace(name_de, name_de == "Platane", "Platanen, Platane")) %>%
    mutate(name_de = replace(name_de, name_de == "Purpur-Erle", "Erlen, Purpur-Erle")) %>%
    mutate(name_de = replace(name_de, name_de == "Purpur-Esche", "Eschen, Purpur-Esche")) %>%
    mutate(name_de = replace(name_de, name_de == "Purpur-Perückenstrauch", "Perückensträucher, Purpur-Perückenstrauch")) %>%    
    mutate(name_de = replace(name_de, name_de == "Quitte", "Cydonia, Quitte")) %>%    
    mutate(name_de = replace(name_de, name_de == "Robusta-Pappel", "Pappeln, Kanadische Pappel 'Robusta'")) %>%
    mutate(name_de = replace(name_de, name_de == "Rosa Schnee-Kirsche", "Prunus, Frühlingskirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Rosskastanie `Briotii`", "Rosskastanien, Rosskastanie `Briotii`")) %>%
    mutate(name_de = replace(name_de, name_de == "Rosskastanie", "Rosskastanien, Rosskastanie")) %>%
    mutate(name_de = replace(name_de, name_de == "Rot-Dorn", "Weißdorne, Echter Rotdorn")) %>%
    mutate(name_de = replace(name_de, name_de == "Roter Schlangenhaut-Ahorn", "Ahorne, Roter Schlangenhaut-Ahorn")) %>%    
    mutate(name_de = replace(name_de, name_de == "Säulen-Eibe", "Eiben, Säulen-Eibe")) %>%
    mutate(name_de = replace(name_de, name_de == "Säulen-Hainbuche", "Hainbuchen, Säulenhainbuche")) %>%
    mutate(name_de = replace(name_de, name_de == "Säulen-Pappel", "Pappeln, Säulenpappel")) %>%
    mutate(name_de = replace(name_de, name_de == "Säulen-Spitz-Ahorn", "Ahorne, Säulen-Spitzahorn")) %>%
    mutate(name_de = replace(name_de, name_de == "Säulen-Weißdorn", "Weißdorne, Säulen-Weißdorn")) %>%
    mutate(name_de = replace(name_de, name_de == "Säulen-Zierkirsche", "Prunus, Japanische Blütenkirsche 'Amanogawa'")) %>%    
    mutate(name_de = replace(name_de, name_de == "Scharlach-Weißdorn", "Weißdorne, Scharlach-Weißdorn")) %>%    
    mutate(name_de = replace(name_de, name_de == "schmalblättrige Ölweide", "Ölweiden, Schmalblättrige Ölweide")) %>%    
    mutate(name_de = replace(name_de, name_de == "Schmalkronige Gleditschie", "Gleditschien, Schmalkronige Gleditschie")) %>%
    mutate(name_de = replace(name_de, name_de == "Schmalkronige Mehlbeere", "Mehlbeeren, Schmalkronige Mehlbeere")) %>%
    mutate(name_de = replace(name_de, name_de == "Schmalkronige Stadt-Ulme", "Ulmen, Schmalkronige Stadtulme")) %>%
    mutate(name_de = replace(name_de, name_de == "Schmalkroniger Rot-Ahorn", "Ahorne, Schmalkroniger Rot-Ahorn")) %>%    
    mutate(name_de = replace(name_de, name_de == "Schnurbaum 'Regent'", "Schnurbäume, Schnurbaum 'Regent'")) %>%
    mutate(name_de = replace(name_de, name_de == "Schnurbaum", "Styphnolobium, Japanischer Schnurbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Schwarz-Kiefer", "Kiefern, Schwarz-Kiefer")) %>%
    mutate(name_de = replace(name_de, name_de == "Schwedler´s Spitz-Ahorn", "Ahorne, Spitzahorn 'Schwedleri'")) %>%
    mutate(name_de = replace(name_de, name_de == "Silber-Linde 'Argentea'", "Linden, Silber-Linde 'Argentea'")) %>%    
    mutate(name_de = replace(name_de, name_de == "Silber-Pappel", "Pappeln, Silber-Pappel")) %>%
    mutate(name_de = replace(name_de, name_de == "Spiegelrinden-Kirsche", "Prunus, Spiegelrinden-Kirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Straßen-Akazie", "Akazien, Straßenakazie")) %>%
    mutate(name_de = replace(name_de, name_de == "Straßen-Esche", "Eschen, Straßenesche")) %>%
    mutate(name_de = replace(name_de, name_de == "Strauch-Eibisch 'Totus albus'", "Straucheibisch, Straucheibisch 'Totus albus'")) %>%
    mutate(name_de = replace(name_de, name_de == "Thüringesche-Mehlbeere", "Mehlbeeren, Thüringer Mehlbeere")) %>%    
    mutate(name_de = replace(name_de, name_de == "Thüringische Mehlbeere", "Mehlbeeren, Thüringer Mehlbeere")) %>%    
    mutate(name_de = replace(name_de, name_de == "Trauer-Weide", "Weiden, Trauerweide")) %>%
    mutate(name_de = replace(name_de, name_de == "Trompetenbaum", "Trompetenbäume, Trompetenbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Tulpen-Magnolie", "Magnolien, Tulpen-Magnolie")) %>%
    mutate(name_de = replace(name_de, name_de == "Tulpenbaum", "Tulpenbäume, Tulpenbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Ulme Dodoens", "Ulmen, Ulme 'Dodoens'")) %>%
    mutate(name_de = replace(name_de, name_de == "Ulme New Horizon", "Ulmen, Ulme 'New Horizon'")) %>%
    mutate(name_de = replace(name_de, name_de == "Ulmus Hybride 'Commelin'", "Ulmen, Ulme 'Commelin'")) %>%
    mutate(name_de = replace(name_de, name_de == "Urweltmammutbaum", "Metasequoia, Urweltmammutbaum")) %>%
    mutate(name_de = replace(name_de, name_de == "Vogel-Kirsche", "Prunus, Vogelkirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Winter-Linde 'Rancho'", "Linden, Winterlinde 'Rancho'")) %>%
    mutate(name_de = replace(name_de, name_de == "Yoshino-Kirsche", "Prunus, Japanische Maienkirsche")) %>%
    mutate(name_de = replace(name_de, name_de == "Zierapfel evereste", "Äpfel, Zierapfel 'Evereste'")) %>%    
    mutate(name_de = replace(name_de, name_de == "Zierapfel sargentii", "Äpfel, Zierapfel 'Sargentii'")) %>%    
    mutate(name_de = replace(name_de, name_de == "Zierapfel", "Äpfel, Zierapfel")) %>%
    mutate(name_de = replace(name_de, name_de == "Chinesische-Birne", "Pyrus, Chinesische-Birne")) %>%
    mutate(name_de = replace(name_de, name_de == "Eibisch", "Malvengewächse, Straucheibisch")) %>%    
    mutate(name_de = replace(name_de, name_de == "Gehölze", "Gehölze, Gehölze")) %>%    
    mutate(name_de = replace(name_de, name_de == "Hängende Nelken-Kirsche", "Prunus, Hängende Nelken-Kirsch")) %>%    
    mutate(name_de = replace(name_de, name_de == "Kanadische Felsenbirne", "Felsenbirnen, Kanadische Felsenbirne")) %>%    
    mutate(name_de = replace(name_de, name_de == "Kirsche", "Prunus, Kirsche")) %>%    
    mutate(name_de = replace(name_de, name_de == "Korkenzieher-Hasel", "Haseln, Korkenzieherhasel")) %>%    
    mutate(name_de = replace(name_de, name_de == "Pagoden-Hartriegel", "Hartriegelgewächse, Pagoden-Hartriegel")) %>%    
    mutate(name_de = replace(name_de, name_de == "Roter-Fächer-Ahorn", "Ahorne, Roter Fächer-Ahorn")) %>%    
    mutate(name_de = replace(name_de, name_de == "Asch-Weide", "Weiden, Asch-Weide")) %>%    
    mutate(name_de = replace(name_de, name_de == "Flesenbirne, kupferrote Felsenbirne", "Felsenbirnen, Kupferrote Felsenbirne")) %>%    
    mutate(name_de = replace(name_de, name_de == "Zwetschge", "Prunus, Pflaume")) %>%    

    separate(name_de, into=c('gattung','name_de'), sep=',', extra='merge', fill='left') %>%

    mutate(gattung = replace(gattung, gattung == "Ahorn", "Ahorne")) %>%    
    mutate(gattung = replace(gattung, gattung == "Apfelbaum", "Äpfel")) %>%    
    mutate(gattung = replace(gattung, gattung == "Arve", "Kiefern")) %>%    
    mutate(gattung = replace(gattung, gattung == "Birke", "Birken")) %>%    
    mutate(gattung = replace(gattung, gattung == "Birne", "Birnen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Buche", "Buchen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Eibe", "Eiben")) %>%    
    mutate(gattung = replace(gattung, gattung == "Erle", "Erlen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Esche", "Eschen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Fichte", "Fichten")) %>%    
    mutate(gattung = replace(gattung, gattung == "Gleditschie", "Gleditschien")) %>%    
    mutate(gattung = replace(gattung, gattung == "Hartriegel", "Hartriegelgewächse")) %>%    
    mutate(gattung = replace(gattung, gattung == "Kastanie", "Kastanien")) %>%    
    mutate(gattung = replace(gattung, gattung == "Kiefer", "Kiefern")) %>%    
    mutate(gattung = replace(gattung, gattung == "Linde", "Linden")) %>%    
    mutate(gattung = replace(gattung, gattung == "Magnolie", "Magnolien")) %>%    
    mutate(gattung = replace(gattung, gattung == "Kirsche", "Prunus")) %>%    
    mutate(gattung = replace(gattung, gattung == "Maulbeerbaum", "Maulbeeren")) %>%    
    mutate(gattung = replace(gattung, gattung == "Mehlbeere", "Mehlbeeren")) %>%    
    mutate(gattung = replace(gattung, gattung == "Nussbaum", "Walnüsse")) %>%    
    mutate(gattung = replace(gattung, gattung == "Pappel", "Pappeln")) %>%    
    mutate(gattung = replace(gattung, gattung == "Platane", "Platanen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Ulme", "Ulmen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Weide", "Weiden")) %>%    
    mutate(gattung = replace(gattung, gattung == "Weißdorn", "Weißdorne")) %>%    
    mutate(gattung = replace(gattung, gattung == "Flügelnuß", "Flügelnüsse")) %>%    
    mutate(gattung = replace(gattung, gattung == "Hasel", "Haseln")) %>%    
    mutate(gattung = replace(gattung, gattung == "Hemlockstanne", "Hemlockstannen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Lärche", "Lärchen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Maulbeere", "Maulbeeren")) %>%    
    mutate(gattung = replace(gattung, gattung == "Rosskastanie", "Rosskastanien")) %>%    
    mutate(gattung = replace(gattung, gattung == "Roßkastanien", "Rosskastanien")) %>%    
    mutate(gattung = replace(gattung, gattung == "Straucheibisch", "Eibisch")) %>%    
    mutate(gattung = replace(gattung, gattung == "Tanne", "Tannen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Wald-Kiefer", "Kiefern")) %>%    
    mutate(gattung = replace(gattung, gattung == "Zürgelbaum", "Zürgelbäume")) %>%    
    mutate(gattung = replace(gattung, gattung == "Eiche", "Eichen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Scheinakazie", "Robinien")) %>%    
    mutate(gattung = replace(gattung, gattung == "Schwarzdorn", "Prunus")) %>%    
    mutate(gattung = replace(gattung, gattung == "Stechpalme", "Stechpalmen")) %>%    
    mutate(gattung = replace(gattung, gattung == "Vogelbeere", "Mehlbeeren")) %>%    
    mutate(gattung = replace(gattung, gattung == "Weißbuche", "Hainbuchen")) %>%    

    select(-c('baumId', 'baumNr', 'AGOL_Name', 'OBJECTID')) %>%
    mutate_if(is.character, trim) %>%
    mutate_if(is.character, as.factor)
```

Das Baumkataster der Stadt Konstanzer enthält in Summe `r nrow(kataster)` Bäume.


#### Gattungen

Das Baumkataster der Stadt Konstanz enthält `r length(unique(kataster[!is.na(kataster$gattung),'gattung']))` verschiedene Gattungen, `r nrow(kataster[is.na(kataster$gattung),])` Einträge haben hier keinen gültigen Wert.


```{r, out.width='800px'}
N <- 50

data <- kataster %>%
  filter(!is.na(gattung)) %>%
  group_by(gattung) %>%
  summarize(n = n()) %>%
  filter(n > N) %>%
  arrange(desc(n))

ggplot(data) +
    geom_bar(aes(x=reorder(gattung, -n), y=n), stat = "identity") +
    labs(title=paste0('Bäume der Stadt Konstanz (Gattungen), Anzahl > ', N), x='Gattung', y='Anzahl Bäume') +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz für Gattungen mit mehr als `r N` Bäumen.**

```{r, out.width='800px', message=FALSE}
N <- 10

#bb <- c(9.08, 47.65, 9.22, 47.75)
#map <- get_stamenmap(bb, maptype="terrain", zoom=14)

bb <- c(9.12, 47.65, 9.22, 47.70)
map <- get_stamenmap(bb, maptype="terrain", zoom=15)

df <- kataster %>% 
    filter(!is.na(gattung)) %>%
    filter(x >= bb[1] & x <= bb[3]) %>%
    filter(y >= bb[2] & y <= bb[4]) %>%
    group_by(gattung) %>%
    summarize(n=n()) %>%
    arrange(desc(n)) %>%
    top_n(N)

data <- kataster %>% 
  filter(gattung %in% df$gattung) %>%
  filter(x >= bb[1] & x <= bb[3]) %>%
  filter(y >= bb[2] & y <= bb[4])

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y, color=gattung), size=0.5, alpha=0.25) +
    labs(title=paste0('Bäume der Stadt Konstanz (Gattungen, Top ', N, ')')) +
    theme_void() +
    theme(legend.position="bottom") +
    scale_color_discrete(name='Gattung') +
    guides(color=guide_legend(override.aes=list(alpha=1, size=1))) 
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz über das Stadtgebiet für Gattungen mit mehr als `r N` Bäumen.**

```{r}
df <- kataster %>% filter(!is.na(stammumfang)) %>% filter(!is.na(hoehe))
V <- (df$stammumfang / 100)**2 / (4*pi) * df$hoehe # m^3
m <- V * 600 # kg
C <- m / 2
sum(C)/1000
```

#### Arten

Das Baumkataster der Stadt Konstanz enthält `r length(unique(kataster[!is.na(kataster$name_de),'name_de']))` verschiedene Arten, `r nrow(kataster[is.na(kataster$name_de),])` Einträge haben hier keinen gültigen Wert.

```{r, out.width='800px'}
N <- 100

data <- kataster %>%
  filter(!is.na(name_de)) %>%
  group_by(name_de) %>%
  summarize(n = n()) %>%
  filter(n > N) %>%
  arrange(desc(n))

ggplot(data) +
    geom_bar(aes(x=reorder(name_de, -n), y=n), stat = "identity") +
    labs(title=paste0('Bäume der Stadt Konstanz (Arten), Anzahl > ', N), x='Art', y='Anzahl Bäume') +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz für Arten mit mehr als `r N` Bäumen.**

```{r, out.width='800px', message=FALSE}
N <- 10

#bb <- c(9.08, 47.65, 9.22, 47.75)
#map <- get_stamenmap(bb, maptype="terrain", zoom=14)

bb <- c(9.12, 47.65, 9.22, 47.70)
map <- get_stamenmap(bb, maptype="terrain", zoom=15)

df <- kataster %>% 
    filter(!is.na(gattung)) %>%
    filter(x >= bb[1] & x <= bb[3]) %>%
    filter(y >= bb[2] & y <= bb[4]) %>%
    group_by(name_de) %>%
    summarize(n=n()) %>%
    arrange(desc(n)) %>%
    top_n(N)

data <- kataster %>% 
  filter(name_de %in% df$name_de) %>%
  filter(x >= bb[1] & x <= bb[3]) %>%
  filter(y >= bb[2] & y <= bb[4])

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y, color=name_de), size=0.5, alpha=0.25) +
    labs(title=paste0('Bäume der Stadt Konstanz (Art, Top ', N, ')')) +
    theme_void() +
    theme(legend.position="bottom") +
    scale_color_discrete(name='Art') +
    guides(color=guide_legend(override.aes=list(alpha=1, size=1))) 
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz für Arten mit mehr als `r N` Bäumen.**

#### Stammumfang

Das Baumkataster der Stadt Konstanz enthält `r nrow(kataster[is.na(kataster$stammumfang),])` Bäume ohne einen gültigen Wert für den Stammumfang.


```{r, out.width='800px'}
ggplot(kataster %>% filter(!is.na(stammumfang))) +
    geom_histogram(aes(x=stammumfang), binwidth=25) +
    labs(title='Bäume der Stadt Konstanz (Stammumfang)', x='Stammumfang [cm]', y='Anzahl Bäume') +
    theme_bw()
```

**Abbildung: Verteilung des Stammumfangs der Bäume der Stadt Konstanz.**

```{r, out.width='800px', message=FALSE}
bb <- c(9.12, 47.65, 9.22, 47.70)
map <- get_stamenmap(bb, maptype="terrain", zoom=15)

data <- kataster %>% 
    filter(!is.na(stammumfang)) %>%
    filter(x >= bb[1] & x <= bb[3]) %>%
    filter(y >= bb[2] & y <= bb[4]) %>%
    arrange(stammumfang)
size <- data$stammumfang / 250

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y, color=stammumfang), size=size, alpha=0.5) +
    labs(title='Bäume der Stadt Konstanz (Stammumfang)') +
    theme_void() +
    theme(legend.position="bottom") +
    scale_color_continuous(name='Stammumfang in Zentimeter')
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz über das Stadtgebiet, hervorgehoben ist der Stammumfang der eingezeichneten Bäume.**

#### Höhe

Das Baumkataster der Stadt Konstanzer enthält `r nrow(kataster[is.na(kataster$hoehe),])` Einträge ohne einen gültigen Wert für die Höhe.

```{r, out.width='800px'}
ggplot(kataster %>% filter(!is.na(hoehe))) +
    geom_histogram(aes(x=hoehe), binwidth=1) +
    labs(title='Bäume der Stadt Konstanz (Höhe)', x='Höhe [m]', y='Anzahl Bäume') +
    theme_bw()
```

**Abbildung: Verteilung der Höhe der Bäume der Stadt Konstanz.**

```{r, fig.align='center', out.width='800px', message=FALSE}
bb <- c(9.12, 47.65, 9.22, 47.70)
map <- get_stamenmap(bb, maptype="terrain", zoom=15)

data <- kataster %>% 
    filter(!is.na(hoehe)) %>%
    filter(x >= bb[1] & x <= bb[3]) %>%
    filter(y >= bb[2] & y <= bb[4]) %>%
    arrange(hoehe)
size <- data$hoehe / 10

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y, color=hoehe), size=size, alpha=0.5) +
    labs(title='Bäume der Stadt Konstanz (Höhe)') +
    theme_void() +
    theme(legend.position="bottom") +
    scale_color_continuous(name='Höhe in Meter')
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz über das Stadtgebiet, hervorgehoben ist die Höhe der eingezeichneten Bäume.**

#### Kronendurchmesser

Das Baumkataster der Stadt Konstanzer enthält `r nrow(kataster[is.na(kataster$kronendurchmesser),])` Einträge ohne einen gültigen Wert für den Kronendurchmesser.

```{r, , fig.align='center', out.width='800px'}
ggplot(kataster %>% filter(!is.na(kronendurchmesser))) +
    geom_histogram(aes(x=kronendurchmesser), binwidth=1) +
    labs(title='Bäume der Stadt Konstanz (Kronendurchmesser)', x='Kronendurchmesser [m]', y='Anzahl Bäume') +
    theme_bw()
```

**Abbildung: Verteilung des Kronendurchmessers der Bäume der Stadt Konstanz.**

```{r, fig.align='center', out.width='800px', message=FALSE}
bb <- c(9.12, 47.65, 9.22, 47.70)
map <- get_stamenmap(bb, maptype="terrain", zoom=15)

data <- kataster %>% 
    filter(!is.na(kronendurchmesser)) %>%
    filter(x >= bb[1] & x <= bb[3]) %>%
    filter(y >= bb[2] & y <= bb[4]) %>%
    arrange(kronendurchmesser)
size <- data$kronendurchmesser / 10

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y, color=kronendurchmesser), size=size, alpha=0.5) +
    labs(title='Bäume der Stadt Konstanz (Kronendurchmesser)') +
    theme_void() +
    theme(legend.position="bottom") +
    scale_color_continuous(name='Kronendurchmesser in Meter')
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz über das Stadtgebiet, hervorgehoben ist der Kronendurchmesser der eingezeichneten Bäume.**

#### Standort

Der Standort mit den mit Abstand meisten Bäumen ist der Hauptfriedhof. Dort lebt es sich offensichtöich am gesündesten. Das Baumkataster der Stadt Konstanzer enthält `r nrow(kataster[is.na(kataster$standort),])` Einträge ohne einen gültigen Wert für den Standort.

```{r, fig.align='center', out.width='800px'}
N <- 75

data <- kataster %>%
  filter(!is.na(name_de)) %>%
  group_by(standort) %>%
  summarize(n = n()) %>%
  filter(n > N) %>%
  arrange(desc(n))

ggplot(data) +
    geom_bar(aes(x=reorder(standort, -n), y=n), stat = "identity") +
    labs(title=paste0('Bäume der Stadt Konstanz (Standort), Anzahl > ', N), x='Standort', y='Anzahl Bäume') +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

**Abbildung: Verteilung der Standorte der Bäume der Stadt Konstanz im Stadtgebiet für Standorte mit mehr als `r N` Bäumen.**

```{r, fig.align='center', out.width='800px', message=FALSE}
bb <- c(9.08, 47.65, 9.22, 47.75)
map <- get_stamenmap(bb, maptype="terrain", zoom=14)

data <- kataster %>% 
  filter(!is.na(y))

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y), size=0.25, alpha=0.25) +
    labs(title='Bäume der Stadt Konstanz (Standorte)') +
    theme_void() +
    theme(legend.position="bottom") 
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz über das Stadtgebiet.**

#### O<sub>2</sub> Produktion

```{r to_centimeter, echo=FALSE}
to_centimeter <- function(inch) return(inch*2.54)
```

Die Sauerstoffproduktion eines Baums ist proportional zu seinem Druchmesser in Brusthöhe (Novak 2007b). Mit einem Durchmesser von `r to_centimeter(1)`–`r to_centimeter(3)` cm produzieren Bäume ≈2.9 kg O<sub>2</sub>/Jahr;  mit `r to_centimeter(9)`–`r to_centimeter(12)` cm: 22.6 kg O<sub>2</sub>/Jahr; `r to_centimeter(18)`–`r to_centimeter(21)` cm: 45.6 kg O<sub>2</sub>/Jahr; `r to_centimeter(27)`–`r to_centimeter(30)` cm: 91.1 kg O<sub>2</sub>/Jahr; und mit mehr als `r to_centimeter(30)` cm: 110.3 kg O<sub>2</sub>/Jahr. Zwischenwerte habe ich gemittelt.

```{r}
# O2 Produktion in Kilogram pro Jahr.
dfs = list(
    # Novak (2007b)
    kataster %>% 
        filter(stammumfang/pi <= to_centimeter(3)) %>%
        mutate(o2_produktion = 2.9),

    #
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(3)) & (stammumfang/pi < to_centimeter(9))) %>%
        mutate(o2_produktion = (2.9 + 22.6)/2),

    # Novak (2007b)
    kataster %>% 
        filter((stammumfang/pi >= to_centimeter(9)) & (stammumfang/pi <= to_centimeter(12))) %>%
        mutate(o2_produktion = 22.6),
    
    #
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(12)) & (stammumfang/pi < to_centimeter(18))) %>%
        mutate(o2_produktion = (22.6 + 45.6)/2),
    
    # Novak (2007b)
    kataster %>% 
        filter((stammumfang/pi >= to_centimeter(18)) & (stammumfang/pi <= to_centimeter(21) )) %>%
        mutate(o2_produktion = 45.6),

    # 
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(21)) &  (stammumfang/pi < to_centimeter(27))) %>%
        mutate(o2_produktion = (45.6 + 91.1)/2),
    
    # Novak (2007b)
    kataster %>% 
        filter((stammumfang/pi >= to_centimeter(27)) & (stammumfang/pi <= to_centimeter(30) )) %>%
        mutate(o2_produktion = 91.1),
    
    # Novak (2007b)
    kataster %>% filter(stammumfang/pi > to_centimeter(30)) %>%
        mutate(o2_produktion = 110.3)
)
kataster <- do.call('rbind', dfs)
```

```{r}
o2_produktion = sum(kataster$o2_produktion)/1000
```

Die Bäume der Stadt Konstanz erzeugen somit pro Jahr `r o2_produktion` Tonnen O<sub>2</sub>.

```{r, fig.align='center', out.width='800px', message=FALSE}
bb <- c(9.08, 47.65, 9.22, 47.75)
map <- get_stamenmap(bb, maptype="terrain", zoom=14)

data <- kataster %>% 
    filter(!is.na(o2_produktion)) %>%
    filter(x >= bb[1] & x <= bb[3]) %>%
    filter(y >= bb[2] & y <= bb[4]) %>%
    arrange(o2_produktion)
size <- data$o2_produktion / 75

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y, color=o2_produktion), size=size, alpha=0.25) +
    labs(title=expression('Bäume der Stadt Konstanz ('*O[2]*'-Produktion)')) +
    theme_void() +
    theme(legend.position="bottom") +
    scale_color_continuous(name=expression('Kilogramm '*O[2]*' pro Jahr'), low = "black", high = "green")
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz im Stadtgebiet, hervorgehoben ist die O<sub>2</sub>-Produktion der eingezeichneten Bäume.**

#### CO<sub>2</sub> Aufnahme

```{r to_kilogramm, echo=FALSE}
to_kilogram <- function(lbs) return(lbs*0.453592)
```

Die Kohlendioxidaufnahme eines Baums ist proportional zu seinem Druchmesser in Brusthöhe (Novak 2007a). Mit einem Durchmesser von `r to_centimeter(1)`–`r to_centimeter(3)` cm nehmen Bäume ≈`r to_kilogram(0.201)` kg CO<sub>2</sub>/Jahr auf;  mit `r to_centimeter(3)`–`r to_centimeter(6)` cm: `r to_kilogram(5.7)` kg CO<sub>2</sub>/Jahr; `r to_centimeter(6)`–`r to_centimeter(9)` cm: `r to_kilogram(10.3)` kg CO<sub>2</sub>/Jahr; `r to_centimeter(27)`–`r to_centimeter(30)` cm: 91.1 kg O<sub>2</sub>/Jahr; und mit mehr als `r to_centimeter(30)` cm: 110.3 kg O<sub>2</sub>/Jahr. Zwischenwerte habe ich gemittelt.

```{r}
# CO2 Aufnahme in Kilogram pro Jahr.
dfs = list(
    # Novak (2007a)
#    kataster %>% 
#        filter(stammumfang/pi <= to_centimeter(3)) %>%
#        mutate(co2_aufnahme = ),

    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(3)) & (stammumfang/pi <= to_centimeter(6))) %>%
        mutate(co2_aufnahme = to_kilogram(5.7)),

    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(6)) & (stammumfang/pi <= to_centimeter(9))) %>%
        mutate(co2_aufnahme = to_kilogram(10.3)),
    
    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(9)) & (stammumfang/pi <= to_centimeter(12))) %>%
        mutate(co2_aufnahme = to_kilogram(16.8)),
    
    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(12)) & (stammumfang/pi <= to_centimeter(15) )) %>%
        mutate(co2_aufnahme = to_kilogram(21.2)),

    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(15)) &  (stammumfang/pi <= to_centimeter(18))) %>%
        mutate(co2_aufnahme = to_kilogram(31.4)),
    
    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(18)) & (stammumfang/pi <= to_centimeter(21) )) %>%
        mutate(co2_aufnahme = 42.7),

    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(21)) & (stammumfang/pi <= to_centimeter(24) )) %>%
        mutate(co2_aufnahme = 45.6),

    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(24)) & (stammumfang/pi <= to_centimeter(27) )) %>%
        mutate(co2_aufnahme = 64.1),

    # Novak (2007a)
    kataster %>% 
        filter((stammumfang/pi > to_centimeter(27)) & (stammumfang/pi <= to_centimeter(30) )) %>%
        mutate(co2_aufnahme = 65.3),
    
    # Novak (2007a)
    kataster %>% filter(stammumfang/pi > to_centimeter(30)) %>%
        mutate(co2_aufnahme = 96.9)
)
kataster <- do.call('rbind', dfs)
```

```{r}
co2_aufnahme = sum(kataster$co2_aufnahme)/1000
```

Die Bäume der Stadt Konstanz nehmen somit pro Jahr `r co2_aufnahme` Tonnen CO<sub>2</sub> auf.

```{r, fig.align='center', out.width='1000px', message=FALSE}
bb <- c(9.08, 47.65, 9.22, 47.75)
map <- get_stamenmap(bb, maptype="terrain", zoom=14)

data <- kataster %>% 
    filter(!is.na(co2_aufnahme)) %>%
    filter(x >= bb[1] & x <= bb[3]) %>%
    filter(y >= bb[2] & y <= bb[4]) %>%
    arrange(co2_aufnahme)
size <- data$co2_aufnahme / 75

ggmap(map) +
    geom_point(data=data, aes(x=x, y=y, color=co2_aufnahme), size=size, alpha=0.25) +
    labs(title=expression('Bäume in Konstanz ('*CO[2]*' Aufnahme)')) +
    theme_void() +
    theme(legend.position="bottom") +
    scale_color_continuous(name=expression('Kilogramm '*CO[2]*' pro Jahr'), low = "black", high = "green")
```

**Abbildung: Verteilung der Bäume der Stadt Konstanz im Stadtgebiet, hervorgehoben ist die CO<sub>2</sub>-Aufnahme der eingezeichneten Bäume.**

### Konstanzer

```{r, warning=FALSE}
vororte <- c('Egg', 'Dettingen', 'Dingelsdorf', 'Litzelstetten', 'Wallhausen')
konstanzer <- read.csv("data/Einwohner_nach_Stadtviertel 2010-2019.csv", sep=";", na.strings=c('','*)')) %>%

    # Fehlende Daten werden herausgefiltert.
    filter(complete.cases(.)) %>%

    # Es lebe ASCII, UTF-8 und andere Unwägbarkeiten.  
    mutate(STADTTEIL = fct_collapse(STADTTEIL, 'Fürstenberg' = c('Fuerstenberg'))) %>%
    mutate(STADTTEIL = fct_collapse(STADTTEIL, 'Königsbau' = c('Koenigsbau'))) %>%
  
    # Einige Variablenamen etwas leiser stellen.
    rename(Stadtteil = STADTTEIL) %>%
    rename(Stadtviertel = STADTVIERTEL) %>%

    # Hurrga! Pivot Zeilen rausschmeißen.
    filter(nchar(Stadtviertel) != 3) %>%
    filter(Stadtteil != 'Stadt Konstanz') %>%
    
    # Zusätzliches Merkmal: (Pseudo-) Verwaltungseinheit.
    mutate(Verwaltungseinheit = as.factor(ifelse(Stadtteil %in% vororte, 'Vorort', 'Stadt'))) %>%
    
    # Besserere Variablename (IMHO) in diesem Kontext.
    mutate(Stichtag = as.Date(Stand_Einwohner, "%d.%m.%y")) %>%

    # Unbenötigte Einwohnerdaten entfernen.
    select(-EINW_HW_GESAMT, -EINW_HW_FRAUEN, -EINW_HW_DEUTSCH, -EINW_HW_AUSLAENDER) %>%
    
    # Altersklassen bilden.
    gather(key="Altersklasse", value="Anzahl", starts_with("EINW_HW")) %>%
    mutate(Altersklasse = factor(Altersklasse)) %>%
    mutate(Altersklasse = fct_recode(Altersklasse, 'unter 18'='EINW_HW_unter18')) %>%
    mutate(Altersklasse = fct_recode(Altersklasse, '18 bis unter 30'='EINW_HW_18_bis_unter_30')) %>%
    mutate(Altersklasse = fct_recode(Altersklasse, '30 bis unter 40'='EINW_HW_30_bis_unter_40')) %>%
    mutate(Altersklasse = fct_recode(Altersklasse, '40 bis unter 50'='EINW_HW_40_bis_unter_50')) %>%
    mutate(Altersklasse = fct_recode(Altersklasse, '50 bis unter 60'='EINW_HW_50_bis_unter_60')) %>%
    mutate(Altersklasse = fct_recode(Altersklasse, 'über 60'='EINW_HW_60_und_aelter')) %>%

    mutate(Anzahl = as.numeric(Anzahl)) %>%
    filter(complete.cases(.)) %>%
    
    group_by(Stadtteil, Verwaltungseinheit, Stichtag, Altersklasse) %>%
    summarize(Anzahl = sum(Anzahl, na.rm=TRUE), .groups='drop')

# Anordnung der Alterklassenbezeichnungen anordnen.
konstanzer$Altersklasse = factor(konstanzer$Altersklasse,levels(konstanzer$Altersklasse)[c(6,1:5)])
```

```{r, out.width='1000px'}
konstanzer %>% 
    filter(Stichtag==as.Date('31.12.2019','%d.%m.%Y') | Stichtag==as.Date('31.12.2010','%d.%m.%Y')) %>%
    filter(Verwaltungseinheit=='Stadt') %>%
    mutate(Stichtag = as.factor(Stichtag)) %>%
    ggplot() + 
        geom_bar(aes(x=Altersklasse, y=Anzahl, fill=Stichtag), stat = "identity", position='dodge') + 
        facet_wrap(Stadtteil~., ncol=3) +
        coord_flip() + 
        labs(x='Altersklasse', y='Anzahl Einwohner', title='Einwohner nach Altersklasse (Konstanz Stadt)') +
        theme_bw() +
        theme(legend.position="bottom")
```

**Abbildung: Verteilung der Konstanzer Einwohner (Stadt) auf Altersklassen.**

```{r, out.width='1000px'}
konstanzer %>% 
    filter(Stichtag==as.Date('31.12.2019','%d.%m.%Y') | Stichtag==as.Date('31.12.2010','%d.%m.%Y')) %>%
    filter(Verwaltungseinheit=='Vorort') %>%
    mutate(Stichtag = as.factor(Stichtag)) %>%
    ggplot() + 
        geom_bar(aes(x=Altersklasse, y=Anzahl, fill=Stichtag), stat = "identity", position='dodge') + 
        facet_wrap(Stadtteil~., ncol=3) +
        coord_flip() + 
        labs(x='Altersklasse', y='Anzahl Einwohner', title='Einwohner nach Altersklasse (Konstanz Vororte)') +
        theme_bw() +
        theme(legend.position="bottom")
```

**Abbildung: Verteilung der Konstanzer Einwohner (Vororte) auf Altersklassen.**

Erwachsene Konstanzer im Jahr 2019
```{r}
erwachsene <- konstanzer %>%
    filter(Stichtag == as.Date('31.12.2019','%d.%m.%Y')) %>%
    filter(Altersklasse != 'unter 18')
sum(erwachsene$Anzahl)
```

#### O<sub>2</sub> Verbrauch

```{r}
# O2 Verbrauch in Kilogram pro Jahr.
# Perry 2003
erwachsene$o2_verbrauch = erwachsene$Anzahl * 0.84 * 365
```

O<sub>2</sub>-Verbrauch der erwachsenen Konstanzer in Tonnen pro Jahr
```{r}
# O2 Verbrauch in Kilogram pro Jahr.
o2_verbrauch = sum(erwachsene$o2_verbrauch)/1000
o2_verbrauch
```

#### CO<sub>2</sub> Produktion

```{r}
# CO2 Produktion in Kilogram pro Jahr.
# Perry 2003
erwachsene$co2_produktion = erwachsene$Anzahl * 1.00 * 365
```

CO<sub>2</sub>-Produktion der erwachsenen Konstanzer in Tonnen pro Jahr
```{r}
co2_produktion = sum(erwachsene$co2_produktion)/1000 
co2_produktion
```

## Bilanz

**Elementare O<sub>2</sub> Bilanz in Tonnen pro Jahr**
```{r}
o2_bilanz <- o2_produktion - o2_verbrauch
o2_bilanz
```

**Elementare CO<sub>2</sub> Bilanz in Tonnen pro Jahr**
```{r}
co2_bilanz = co2_produktion - co2_aufnahme
co2_bilanz
```

## Zusammenfassung

Die O<sub>2</sub> Bilanz ist **negativ**, dh es wird mehr Sauerstoff von den Konstanzer Einwohnern verbraucht als von den Bäumen der Stadt Konstanz hergestellt wird.

Die CO<sub>2</sub> Bilanz ist **positiv**, dh es wird mehr Kohlendioxid von den Konstanzer Einwohnern erzeugt als von den Bäumen der Stadt Konstanz aufgenommen wird wird.

### Shout-Out

Ermöglicht wurde das ganze im Rahmen HACK AND HARVEST Hackathon 2021 mit:

1. Offene Daten ([Baumkataster der Stadt Konstanz](https://offenedaten-konstanz.de/dataset/baumkataster-konstanz), [Konstanzer Einwohner nach Stadvierteln 2010-2019](https://offenedaten-konstanz.de/dataset/konstanzer-einwohner-nach-stadtvierteln))
2. Freier Zugriff auf Forschungsergebnisse (siehe Literatur)
3. Frei erhältliche Software ([R](https://www.r-project.org), [RStudio](https://www.rstudio.com), [tidyverse](https://www.tidyverse.org), ...)

## Literatur

Nowak, David J.; Hoehn, Robert E. III, Crane, Daniel E.; Stevens, Jack C.; Walton, Jeffrey T. (2007a) Assessing urban forest effects and values, New York City’s urban forest. Resour. Bull. NRS-9. Newtown Square, PA: U.S. Department of Agriculture, Forest Service, Northern Research Station. 22 p. Heruntergeladen am 16.04.2021 von [hier](https://www.nrs.fs.fed.us/pubs/rb/rb_nrs009.pdf)

Nowak, David J.; Crane, Daniel E. (2007b) Oxygen production by urban trees in the United States; Arboriculture & Urban Forestry 33(3); Heruntergeladen am 16.04.2021 von [hier](https://www.researchgate.net/publication/228633757_Oxygen_production_by_urban_trees_in_the_United_States)

Perry, J.; LeVan, M.D. (2003) Air Purification in Closed Environments: Overview of Spacecraft Systems. U.S. Army Natrick Soldier Center.; Heruntergeladen am 17.04.2021 von [hier](https://www.researchgate.net/profile/Jay-Perry/publication/23903409_Air_Purification_in_Closed_Environments_An_Overview_of_Spacecraft_Systems/links/54f78f510cf2ccffe9db44b4/Air-Purification-in-Closed-Environments-An-Overview-of-Spacecraft-Systems.pdf)

## Anhang

```{r to_centimeter, echo=TRUE}
```

```{r to_kilogramm, echo=TRUE}
```

```{r trim, echo=TRUE}
```
